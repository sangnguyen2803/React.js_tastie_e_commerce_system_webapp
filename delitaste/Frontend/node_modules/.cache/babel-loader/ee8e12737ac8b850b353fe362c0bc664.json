{"ast":null,"code":"import { UPDATE_REGISTER_STEP_STYLING, UPDATE_REGISTRATION_FORM, MAP_REGISTRATION_FORM, REGISTER_SUCCESS, REGISTER_FAIL, LOGIN_SUCCESS, LOGIN_FAIL, CHECK_DUPLICATION_SUCCESS, SET_EMAIL_VERIFICATION_CODE, SET_EMAIL_VERIFICATION_STATUS, GET_PROFILE_SUCCESS, RETRIEVE_TOKEN, SET_LOADING, SIGN_OUT, GET_PROVIDER_DETAIL, GET_CONTACT, GET_NOTIFICATION, SET_READ_STATUS, SET_NOTIFICATION_SOCKET } from \"store/actions/types\";\nimport { GET_CART, ADD_TO_CART, UPDATE_CART, CLEAR_CART, REMOVE_CART, INCREASE_PRODUCT, DESCREASE_PRODUCT, SET_CURRENT_LOCATION } from \"store/actions/types\";\nimport storage from \"redux-persist/lib/storage\";\nimport { persistReducer } from \"redux-persist\";\nimport io from \"socket.io-client\";\nconst persistConfig = {\n  key: \"user\",\n  storage,\n  whitelist: []\n};\nconst initialState = {\n  currentForm: 0,\n  //provider-registration\n  formData: {},\n  isEmailVerified: false,\n  isUserAuthenticated: false,\n  isLoading: true,\n  //loading component after calling api.\n  loginState: false,\n  provider_id: -1,\n  //provider created by user\n  profile: [],\n  styling: [\"active\", \"default\", \"default\", \"default\"],\n  refreshToken: localStorage.getItem(\"refreshToken\"),\n  verifiedEmailToken: localStorage.getItem(\"verified_email_token\"),\n  currentAddress: {\n    loading: false,\n    address: \"\",\n    latitude: 0,\n    longitude: 0\n  },\n  phone: null,\n  location: [],\n  notifications: [],\n  socket: io(`http://157.230.243.92:3015`),\n  userCart: {\n    cart: [],\n    date: \"\",\n    provider_id: -1,\n    provider_name: -1,\n    status: -1,\n    user_id: -1\n  },\n  currentProvider: {}\n};\n\nconst UserReducer = (state = initialState, action) => {\n  const {\n    type,\n    payload\n  } = action;\n\n  switch (type) {\n    case SET_NOTIFICATION_SOCKET:\n      let prevNotification = { ...state\n      };\n      prevNotification.notifications.unshift(payload.notification);\n      return { ...state,\n        ...prevNotification\n      };\n\n    case GET_CONTACT:\n      return { ...state,\n        phone: payload.phone,\n        location: payload.address\n      };\n\n    case REGISTER_SUCCESS:\n      localStorage.setItem(\"refreshToken\", payload.refreshtoken);\n      return { ...state,\n        ...payload,\n        currentForm: 2,\n        profile: payload.profile,\n        styling: [\"finished\", \"finished\", \"active\", \"default\"],\n        isUserAuthenticated: true\n      };\n\n    case REGISTER_FAIL:\n      localStorage.removeItem(\"refreshToken\");\n      return { ...state,\n        ...payload,\n        refreshToken: null,\n        isUserAuthenticated: false,\n        profile: null\n      };\n\n    case LOGIN_SUCCESS:\n      localStorage.setItem(\"refreshToken\", payload.refreshToken);\n      return { ...state,\n        ...payload,\n        refreshToken: payload.refreshToken,\n        profile: payload.profile,\n        isUserAuthenticated: true\n      };\n\n    case LOGIN_FAIL:\n      localStorage.removeItem(\"refreshToken\");\n      return { ...state,\n        ...payload,\n        profile: null,\n        isUserAuthenticated: true\n      };\n\n    case SIGN_OUT:\n      localStorage.removeItem(\"refreshToken\");\n      return { ...state,\n        ...payload,\n        refreshToken: null\n      };\n\n    case CHECK_DUPLICATION_SUCCESS:\n      return { ...state,\n        ...payload,\n        isForm1Submitted: true,\n        currentForm: 1,\n        styling: [\"finished\", \"active\", \"default\", \"default\"]\n      };\n\n    case SET_EMAIL_VERIFICATION_CODE:\n      localStorage.setItem(\"verified_email_token\", payload.result.verifyEmailToken);\n      return { ...state,\n        ...payload,\n        verifiedEmailToken: payload.result.verifyEmailToken\n      };\n\n    case SET_LOADING:\n      return { ...state,\n        ...payload\n      };\n\n    case MAP_REGISTRATION_FORM:\n      return { ...state,\n        ...payload\n      };\n\n    case UPDATE_REGISTER_STEP_STYLING:\n      return { ...state,\n        ...payload\n      };\n\n    case UPDATE_REGISTRATION_FORM:\n      return { ...state,\n        ...payload\n      };\n\n    case SET_EMAIL_VERIFICATION_STATUS:\n      return { ...state,\n        ...payload\n      };\n\n    case GET_PROFILE_SUCCESS:\n      return { ...state,\n        ...payload\n      };\n\n    case RETRIEVE_TOKEN:\n      return { ...state,\n        ...payload\n      };\n\n    case GET_PROVIDER_DETAIL:\n      return { ...state,\n        ...payload\n      };\n\n    case GET_CART:\n      return { ...state,\n        ...payload\n      };\n\n    case CLEAR_CART:\n      return { ...state,\n        ...payload\n      };\n\n    case SET_CURRENT_LOCATION:\n      localStorage.setItem(\"current_lat\", payload.currentAddress.latitude);\n      localStorage.setItem(\"current_long\", payload.currentAddress.longitude);\n      return { ...state,\n        ...payload\n      };\n\n    case REMOVE_CART:\n      let copy = { ...state\n      };\n      let removedPosition = copy.userCart.cart.findIndex(element => element.product_id === payload.product_id && element.item_code === payload.item_code);\n      console.log(removedPosition);\n      copy.userCart.cart.splice(removedPosition, 1);\n      return { ...state,\n        ...copy\n      };\n\n    case ADD_TO_CART:\n      if (payload.userCart.provider_id !== state.userCart.provider_id) {\n        return { ...state,\n          userCart: {\n            provider_id: parseInt(payload.userCart.provider_id),\n            user_id: payload.userCart.user_id,\n            provider_name: payload.userCart.provider_name,\n            date: payload.userCart.date,\n            status: payload.userCart.status,\n            cart: [payload.userCart.cartItem]\n          }\n        };\n      }\n\n      var itemInCart = [];\n      let isProductExist = state.userCart.cart.some(item => item.product_id === payload.userCart.cartItem.product_id);\n\n      if (isProductExist) {\n        const newState = [...state.userCart.cart];\n        const index = state.userCart.cart.findIndex(element => element.product_id === payload.userCart.cartItem.product_id);\n        newState[index] = payload.userCart.cartItem;\n        itemInCart = newState;\n      } else {\n        itemInCart = [...state.userCart.cart, payload.userCart.cartItem];\n      }\n\n      return { ...state,\n        userCart: {\n          provider_id: parseInt(payload.userCart.provider_id),\n          user_id: payload.userCart.user_id,\n          provider_name: payload.userCart.provider_name,\n          date: payload.userCart.date,\n          status: payload.userCart.status,\n          cart: itemInCart\n        }\n      };\n\n    case UPDATE_CART:\n      return { ...state,\n        userCart: {\n          provider_id: payload.userCart.provider_id,\n          user_id: payload.userCart.user_id,\n          provider_name: payload.userCart.provider_name,\n          date: payload.userCart.date,\n          status: payload.userCart.status,\n          cart: itemInCart\n        }\n      };\n\n    case INCREASE_PRODUCT:\n      {\n        let prevCart = [...state.userCart.cart];\n        let position = state.userCart.cart.indexOf(payload.cart);\n        prevCart[position].quantity += 1;\n        prevCart[position].totalProductPrice += prevCart[position].productPrice;\n        return { ...state,\n          userCart: { ...state.userCart,\n            cart: prevCart\n          }\n        };\n      }\n\n    case DESCREASE_PRODUCT:\n      {\n        let prevCart = [...state.userCart.cart];\n        let position = state.userCart.cart.indexOf(payload.cart);\n        prevCart[position].quantity -= 1;\n        prevCart[position].totalProductPrice -= prevCart[position].productPrice;\n        return { ...state,\n          userCart: { ...state.userCart,\n            cart: prevCart\n          }\n        };\n      }\n\n    case SET_READ_STATUS:\n      let temp = { ...state\n      };\n      let updatePosition = temp.notifications.findIndex(element => element.id === payload.notification_id);\n      console.log(updatePosition);\n      temp.notifications[updatePosition].read_status = true;\n      return { ...state,\n        ...temp\n      };\n\n    case GET_NOTIFICATION:\n      return { ...state,\n        ...payload\n      };\n\n    default:\n      return state;\n  }\n};\n\n_c = UserReducer;\nexport default persistReducer(persistConfig, UserReducer);\n\nvar _c;\n\n$RefreshReg$(_c, \"UserReducer\");","map":{"version":3,"sources":["/Users/hoangnam/4thYear/FinalProject/18VP-Graduation_Project-Tastie-Frontend/delitaste/Frontend/src/store/reducers/UserReducer/UserReducer.js"],"names":["UPDATE_REGISTER_STEP_STYLING","UPDATE_REGISTRATION_FORM","MAP_REGISTRATION_FORM","REGISTER_SUCCESS","REGISTER_FAIL","LOGIN_SUCCESS","LOGIN_FAIL","CHECK_DUPLICATION_SUCCESS","SET_EMAIL_VERIFICATION_CODE","SET_EMAIL_VERIFICATION_STATUS","GET_PROFILE_SUCCESS","RETRIEVE_TOKEN","SET_LOADING","SIGN_OUT","GET_PROVIDER_DETAIL","GET_CONTACT","GET_NOTIFICATION","SET_READ_STATUS","SET_NOTIFICATION_SOCKET","GET_CART","ADD_TO_CART","UPDATE_CART","CLEAR_CART","REMOVE_CART","INCREASE_PRODUCT","DESCREASE_PRODUCT","SET_CURRENT_LOCATION","storage","persistReducer","io","persistConfig","key","whitelist","initialState","currentForm","formData","isEmailVerified","isUserAuthenticated","isLoading","loginState","provider_id","profile","styling","refreshToken","localStorage","getItem","verifiedEmailToken","currentAddress","loading","address","latitude","longitude","phone","location","notifications","socket","userCart","cart","date","provider_name","status","user_id","currentProvider","UserReducer","state","action","type","payload","prevNotification","unshift","notification","setItem","refreshtoken","removeItem","isForm1Submitted","result","verifyEmailToken","copy","removedPosition","findIndex","element","product_id","item_code","console","log","splice","parseInt","cartItem","itemInCart","isProductExist","some","item","newState","index","prevCart","position","indexOf","quantity","totalProductPrice","productPrice","temp","updatePosition","id","notification_id","read_status"],"mappings":"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","sourcesContent":["import {\n  UPDATE_REGISTER_STEP_STYLING,\n  UPDATE_REGISTRATION_FORM,\n  MAP_REGISTRATION_FORM,\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  CHECK_DUPLICATION_SUCCESS,\n  SET_EMAIL_VERIFICATION_CODE,\n  SET_EMAIL_VERIFICATION_STATUS,\n  GET_PROFILE_SUCCESS,\n  RETRIEVE_TOKEN,\n  SET_LOADING,\n  SIGN_OUT,\n  GET_PROVIDER_DETAIL,\n  GET_CONTACT,\n  GET_NOTIFICATION,\n  SET_READ_STATUS,\n  SET_NOTIFICATION_SOCKET,\n} from \"store/actions/types\";\nimport {\n  GET_CART,\n  ADD_TO_CART,\n  UPDATE_CART,\n  CLEAR_CART,\n  REMOVE_CART,\n  INCREASE_PRODUCT,\n  DESCREASE_PRODUCT,\n  SET_CURRENT_LOCATION,\n} from \"store/actions/types\";\nimport storage from \"redux-persist/lib/storage\";\nimport { persistReducer } from \"redux-persist\";\nimport io from \"socket.io-client\";\n\nconst persistConfig = {\n  key: \"user\",\n  storage,\n  whitelist: [],\n};\n\nconst initialState = {\n  currentForm: 0, //provider-registration\n  formData: {},\n  isEmailVerified: false,\n  isUserAuthenticated: false,\n  isLoading: true, //loading component after calling api.\n  loginState: false,\n  provider_id: -1, //provider created by user\n  profile: [],\n  styling: [\"active\", \"default\", \"default\", \"default\"],\n  refreshToken: localStorage.getItem(\"refreshToken\"),\n  verifiedEmailToken: localStorage.getItem(\"verified_email_token\"),\n  currentAddress: {\n    loading: false,\n    address: \"\",\n    latitude: 0,\n    longitude: 0,\n  },\n  phone: null,\n  location: [],\n  notifications: [],\n  socket: io(`http://157.230.243.92:3015`),\n  userCart: {\n    cart: [],\n    date: \"\",\n    provider_id: -1,\n    provider_name: -1,\n    status: -1,\n    user_id: -1,\n  },\n  currentProvider: {},\n};\nconst UserReducer = (state = initialState, action) => {\n  const { type, payload } = action;\n  switch (type) {\n    case SET_NOTIFICATION_SOCKET:\n      let prevNotification = { ...state };\n      prevNotification.notifications.unshift(payload.notification);\n      return {\n        ...state,\n        ...prevNotification,\n      };\n    case GET_CONTACT:\n      return { ...state, phone: payload.phone, location: payload.address };\n    case REGISTER_SUCCESS:\n      localStorage.setItem(\"refreshToken\", payload.refreshtoken);\n      return {\n        ...state,\n        ...payload,\n        currentForm: 2,\n        profile: payload.profile,\n        styling: [\"finished\", \"finished\", \"active\", \"default\"],\n        isUserAuthenticated: true,\n      };\n    case REGISTER_FAIL:\n      localStorage.removeItem(\"refreshToken\");\n      return {\n        ...state,\n        ...payload,\n        refreshToken: null,\n        isUserAuthenticated: false,\n        profile: null,\n      };\n    case LOGIN_SUCCESS:\n      localStorage.setItem(\"refreshToken\", payload.refreshToken);\n      return {\n        ...state,\n        ...payload,\n        refreshToken: payload.refreshToken,\n        profile: payload.profile,\n        isUserAuthenticated: true,\n      };\n    case LOGIN_FAIL:\n      localStorage.removeItem(\"refreshToken\");\n      return {\n        ...state,\n        ...payload,\n        profile: null,\n        isUserAuthenticated: true,\n      };\n    case SIGN_OUT:\n      localStorage.removeItem(\"refreshToken\");\n      return {\n        ...state,\n        ...payload,\n        refreshToken: null,\n      };\n    case CHECK_DUPLICATION_SUCCESS:\n      return {\n        ...state,\n        ...payload,\n        isForm1Submitted: true,\n        currentForm: 1,\n        styling: [\"finished\", \"active\", \"default\", \"default\"],\n      };\n    case SET_EMAIL_VERIFICATION_CODE:\n      localStorage.setItem(\n        \"verified_email_token\",\n        payload.result.verifyEmailToken\n      );\n      return {\n        ...state,\n        ...payload,\n        verifiedEmailToken: payload.result.verifyEmailToken,\n      };\n\n    case SET_LOADING:\n      return { ...state, ...payload };\n    case MAP_REGISTRATION_FORM:\n      return { ...state, ...payload };\n    case UPDATE_REGISTER_STEP_STYLING:\n      return { ...state, ...payload };\n    case UPDATE_REGISTRATION_FORM:\n      return { ...state, ...payload };\n    case SET_EMAIL_VERIFICATION_STATUS:\n      return { ...state, ...payload };\n    case GET_PROFILE_SUCCESS:\n      return { ...state, ...payload };\n    case RETRIEVE_TOKEN:\n      return { ...state, ...payload };\n    case GET_PROVIDER_DETAIL:\n      return { ...state, ...payload };\n    case GET_CART:\n      return { ...state, ...payload };\n    case CLEAR_CART:\n      return { ...state, ...payload };\n    case SET_CURRENT_LOCATION:\n      localStorage.setItem(\"current_lat\", payload.currentAddress.latitude);\n      localStorage.setItem(\"current_long\", payload.currentAddress.longitude);\n      return { ...state, ...payload };\n    case REMOVE_CART:\n      let copy = { ...state };\n      let removedPosition = copy.userCart.cart.findIndex(\n        (element) =>\n          element.product_id === payload.product_id &&\n          element.item_code === payload.item_code\n      );\n      console.log(removedPosition);\n      copy.userCart.cart.splice(removedPosition, 1);\n      return {\n        ...state,\n        ...copy,\n      };\n    case ADD_TO_CART:\n      if (payload.userCart.provider_id !== state.userCart.provider_id) {\n        return {\n          ...state,\n          userCart: {\n            provider_id: parseInt(payload.userCart.provider_id),\n            user_id: payload.userCart.user_id,\n            provider_name: payload.userCart.provider_name,\n            date: payload.userCart.date,\n            status: payload.userCart.status,\n            cart: [payload.userCart.cartItem],\n          },\n        };\n      }\n      var itemInCart = [];\n      let isProductExist = state.userCart.cart.some(\n        (item) => item.product_id === payload.userCart.cartItem.product_id\n      );\n      if (isProductExist) {\n        const newState = [...state.userCart.cart];\n        const index = state.userCart.cart.findIndex(\n          (element) =>\n            element.product_id === payload.userCart.cartItem.product_id\n        );\n        newState[index] = payload.userCart.cartItem;\n        itemInCart = newState;\n      } else {\n        itemInCart = [...state.userCart.cart, payload.userCart.cartItem];\n      }\n\n      return {\n        ...state,\n        userCart: {\n          provider_id: parseInt(payload.userCart.provider_id),\n          user_id: payload.userCart.user_id,\n          provider_name: payload.userCart.provider_name,\n          date: payload.userCart.date,\n          status: payload.userCart.status,\n          cart: itemInCart,\n        },\n      };\n    case UPDATE_CART:\n      return {\n        ...state,\n        userCart: {\n          provider_id: payload.userCart.provider_id,\n          user_id: payload.userCart.user_id,\n          provider_name: payload.userCart.provider_name,\n          date: payload.userCart.date,\n          status: payload.userCart.status,\n          cart: itemInCart,\n        },\n      };\n    case INCREASE_PRODUCT: {\n      let prevCart = [...state.userCart.cart];\n      let position = state.userCart.cart.indexOf(payload.cart);\n\n      prevCart[position].quantity += 1;\n      prevCart[position].totalProductPrice += prevCart[position].productPrice;\n      return {\n        ...state,\n        userCart: {\n          ...state.userCart,\n          cart: prevCart,\n        },\n      };\n    }\n    case DESCREASE_PRODUCT: {\n      let prevCart = [...state.userCart.cart];\n      let position = state.userCart.cart.indexOf(payload.cart);\n      prevCart[position].quantity -= 1;\n      prevCart[position].totalProductPrice -= prevCart[position].productPrice;\n      return {\n        ...state,\n        userCart: {\n          ...state.userCart,\n          cart: prevCart,\n        },\n      };\n    }\n    case SET_READ_STATUS:\n      let temp = { ...state };\n      let updatePosition = temp.notifications.findIndex(\n        (element) => element.id === payload.notification_id\n      );\n      console.log(updatePosition);\n      temp.notifications[updatePosition].read_status = true;\n      return {\n        ...state,\n        ...temp,\n      };\n    case GET_NOTIFICATION:\n      return { ...state, ...payload };\n    default:\n      return state;\n  }\n};\n\nexport default persistReducer(persistConfig, UserReducer);\n"]},"metadata":{},"sourceType":"module"}