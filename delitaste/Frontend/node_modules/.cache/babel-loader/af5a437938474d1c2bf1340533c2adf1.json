{"ast":null,"code":"var _jsxFileName = \"/Users/hoangnam/4thYear/FinalProject/18VP-Graduation_Project-Tastie-Frontend/delitaste/Frontend/src/components/MerchantDashboard/DashboardFeatures/MDOrder/OrderDetail.js\",\n    _s = $RefreshSig$();\n\nimport { Fragment, useState, useEffect } from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowCircleRight, faCheckCircle, faCircleNotch, faCommentDots, faDotCircle, faEllipsisH, faTimesCircle, faUtensils } from \"@fortawesome/fontawesome-free-solid\";\nimport { css } from \"@emotion/react\";\nimport orderListData from \"components/MerchantDashboard/DashboardFeatures/MDOrder/data/orderListData\";\nimport \"../Panel.scss\";\nimport ViewOrderDetail from \"./OrderHandler/ViewOrderDetail\";\nimport ProgressBar from \"components/Commons/ProgressBar/ProgressBar\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport { withRouter } from \"react-router-dom\";\nimport { getAllOrderAPI } from \"store/actions/ProviderAction/ProviderAction\";\nimport { getAllProductFromOrderAPI, getOrderStatusAPI } from \"store/actions/OrderAction/OrderAction\";\nimport MDHeader from \"components/MerchantDashboard/MDHeader/MDHeader\";\nimport Loader from \"react-spinners/ScaleLoader\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction OrderDetail(props) {\n  _s();\n\n  var _provider$orderList;\n\n  const [loading, setLoading] = useState(false);\n  const {\n    user,\n    provider,\n    getAllOrderAPI,\n    getAllProductFromOrderAPI,\n    getOrderStatusAPI\n  } = props;\n  const [statusOnView, setStatusOnView] = useState(-1);\n  const [orderList, setOrderList] = useState([]);\n  const [orderSummary, setOrderSummary] = useState(orderList[0]);\n  const [orderItems, setOrderItems] = useState([]);\n  let [color, setColor] = useState(\"#910000\");\n  const override = css`\n    display: block;\n    border-color: #910000;\n    font-size: 14px;\n    color: red;\n  `;\n\n  const filterOrderList = type => {\n    const filteredOrderList = orderListData.filter(order => order.order_status === type);\n    setOrderList(filteredOrderList);\n  };\n\n  useEffect(() => {\n    filterOrderList(props.type);\n  }, [props.type]); //fetch order list for the first time\n\n  useEffect(() => {\n    async function fetchAllOrders(id) {\n      setLoading(false);\n      let limit = 50;\n      let offset = 1;\n      const result = await getAllOrderAPI(id, limit, offset);\n      setLoading(true);\n    } //fetch new order list when order in store is empty\n\n\n    if (user.provider_id !== -1 && !provider.orderList.length) {\n      fetchAllOrders(user.provider_id);\n      return;\n    }\n\n    setLoading(true);\n  }, [user.provider_id]);\n  useEffect(() => {\n    if (user.provider_id !== -1) {\n      provider.socket.emit(\"join-room\", `provider-${user.provider_id}`);\n      console.log(`provider-${user.provider_id}`);\n      provider.socket.on(\"provider-received-order\", async (orderData, customerData, order_code, pricing) => {\n        console.log(\"check:\", orderData, customerData, order_code, pricing);\n        const result1 = await getAllProductFromOrderAPI(order_code);\n        const result2 = await getOrderStatusAPI(order_code);\n        Promise.all([result1, result2]).then(data => {\n          setOrderItems(data[0]);\n          setOrderSummary(data[1]);\n\n          if (pricing.deliveryMode === 2) {\n            setStatusOnView(2);\n          } else {\n            setStatusOnView(1);\n          }\n        });\n      });\n      provider.socket.on(\"order-accepted\", data => {\n        setStatusOnView(2);\n      });\n    }\n  }, [user.provider_id]);\n\n  const viewOrderDetail = code => {\n    async function fetchOrderDetail(orderCode) {\n      const result1 = await getAllProductFromOrderAPI(orderCode);\n      const result2 = await getOrderStatusAPI(orderCode);\n      Promise.all([result1, result2]).then(data => {\n        setOrderItems(data[0]);\n        setOrderSummary(data[1]);\n      });\n    }\n\n    fetchOrderDetail(code);\n  };\n\n  const mapOrderStatusIcon = status => {\n    switch (status) {\n      case 3:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            className: \"o-order-icon-history inprogress\",\n            icon: faDotCircle\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"order-status-text-blue\",\n            children: \"Processing\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n\n      case 5:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            className: \"o-order-icon-history done\",\n            icon: faCheckCircle\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"order-status-text-green\",\n            children: \"Completed\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n\n      case 6:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            className: \"o-order-icon-history cancel\",\n            icon: faTimesCircle\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"order-status-text-red\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n\n      default:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            className: \"o-order-icon-history pending\",\n            icon: faCircleNotch\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"order-status-text-yellow\",\n            children: \"Awaiting\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"double-panel-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main-detail-panel-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(MDHeader, {\n          visible: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"panel-detail-title\",\n          children: \"Your orders\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-list-info-row\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-list-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-stock-quantity\",\n              children: [provider.orderList.length, \" Orders\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-stock-quantity-description\",\n              children: [props.type, \" orders: \", provider.orderList.length]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-progress-bar\",\n              children: /*#__PURE__*/_jsxDEV(ProgressBar, {\n                bgcolor: \"#940000\",\n                progress: `${provider.orderList.length}`,\n                height: \"6px\",\n                length: 50\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"o-order-container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"o-order-header-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"o-order o-order-icon\",\n              children: \"Order status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"o-order o-order-id\",\n              children: \"Order Id\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"o-order o-order-name\",\n              children: \"Customer name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"o-order o-order-time\",\n              children: \"Submitted time\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"o-order o-order-quantity\",\n              children: \"Payment\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"o-order o-order-price\",\n              children: \"Total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"o-order-container\",\n          children: (_provider$orderList = provider.orderList) === null || _provider$orderList === void 0 ? void 0 : _provider$orderList.map(order => {\n            var _order$total_amount;\n\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"o-order-row\",\n              onClick: () => {\n                setStatusOnView(order.status);\n                viewOrderDetail(order.order_code);\n              },\n              style: (orderSummary === null || orderSummary === void 0 ? void 0 : orderSummary.order_code) === (order === null || order === void 0 ? void 0 : order.order_code) ? {\n                backgroundColor: \"#f3f3f3\"\n              } : {\n                backgroundColor: \"white\"\n              },\n              children: [mapOrderStatusIcon(order.status), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"o-order o-order-id\",\n                children: order.order_code\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"o-order o-order-name\",\n                children: `${order.user_first_name} ${order.user_last_name}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"o-order-time\",\n                children: order.update_at\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"o-order-quantity\",\n                children: order.payment_name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"o-order-price\",\n                children: [\"$ \", (_order$total_amount = order.total_amount) === null || _order$total_amount === void 0 ? void 0 : _order$total_amount.toFixed(2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 19\n              }, this)]\n            }, order.order_code, true, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"o-order-container\",\n          style: {\n            height: 500,\n            display: \"flex\",\n            flexDirection: \"column\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            borderBottom: \"2px solid #d8d8d8\",\n            borderLeft: \"2px solid #d8d8d8\",\n            borderRight: \"2px solid #d8d8d8\",\n            gap: 10\n          },\n          children: [/*#__PURE__*/_jsxDEV(Loader, {\n            color: color,\n            loading: true,\n            css: override,\n            size: 100,\n            margin: 3,\n            speedMultiplier: 0.8\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"o-order-container-text\",\n            children: \"Please wait for a while ...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sub-detail-panel-wrapper\",\n        style: {\n          paddingTop: \"0\"\n        },\n        children: /*#__PURE__*/_jsxDEV(ViewOrderDetail, {\n          setOrderItems: setOrderItems,\n          setOrderSummary: setOrderSummary,\n          orderItems: orderItems,\n          orderSummary: orderSummary,\n          orderStatus: statusOnView,\n          socket: provider.socket\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 162,\n    columnNumber: 5\n  }, this);\n}\n\n_s(OrderDetail, \"uzbEivz9cVZeX++5aRN5CP8KnPk=\");\n\n_c = OrderDetail;\nOrderDetail.propTypes = {\n  user: PropTypes.object.isRequired,\n  provider: PropTypes.object.isRequired,\n  getAllOrderAPI: PropTypes.func.isRequired,\n  getAllProductFromOrderAPI: PropTypes.func.isRequired,\n  getOrderStatusAPI: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n  user: state.UserReducer,\n  provider: state.ProviderReducer\n});\n\nexport default withRouter(connect(mapStateToProps, {\n  getAllOrderAPI,\n  getAllProductFromOrderAPI,\n  getOrderStatusAPI\n})(OrderDetail));\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderDetail\");","map":{"version":3,"sources":["/Users/hoangnam/4thYear/FinalProject/18VP-Graduation_Project-Tastie-Frontend/delitaste/Frontend/src/components/MerchantDashboard/DashboardFeatures/MDOrder/OrderDetail.js"],"names":["Fragment","useState","useEffect","FontAwesomeIcon","faArrowCircleRight","faCheckCircle","faCircleNotch","faCommentDots","faDotCircle","faEllipsisH","faTimesCircle","faUtensils","css","orderListData","ViewOrderDetail","ProgressBar","connect","PropTypes","withRouter","getAllOrderAPI","getAllProductFromOrderAPI","getOrderStatusAPI","MDHeader","Loader","OrderDetail","props","loading","setLoading","user","provider","statusOnView","setStatusOnView","orderList","setOrderList","orderSummary","setOrderSummary","orderItems","setOrderItems","color","setColor","override","filterOrderList","type","filteredOrderList","filter","order","order_status","fetchAllOrders","id","limit","offset","result","provider_id","length","socket","emit","console","log","on","orderData","customerData","order_code","pricing","result1","result2","Promise","all","then","data","deliveryMode","viewOrderDetail","code","fetchOrderDetail","orderCode","mapOrderStatusIcon","status","map","backgroundColor","user_first_name","user_last_name","update_at","payment_name","total_amount","toFixed","height","display","flexDirection","justifyContent","alignItems","borderBottom","borderLeft","borderRight","gap","paddingTop","propTypes","object","isRequired","func","mapStateToProps","state","UserReducer","ProviderReducer"],"mappings":"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","sourcesContent":["import { Fragment, useState, useEffect } from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faArrowCircleRight,\n  faCheckCircle,\n  faCircleNotch,\n  faCommentDots,\n  faDotCircle,\n  faEllipsisH,\n  faTimesCircle,\n  faUtensils,\n} from \"@fortawesome/fontawesome-free-solid\";\nimport { css } from \"@emotion/react\";\nimport orderListData from \"components/MerchantDashboard/DashboardFeatures/MDOrder/data/orderListData\";\nimport \"../Panel.scss\";\nimport ViewOrderDetail from \"./OrderHandler/ViewOrderDetail\";\nimport ProgressBar from \"components/Commons/ProgressBar/ProgressBar\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport { withRouter } from \"react-router-dom\";\nimport { getAllOrderAPI } from \"store/actions/ProviderAction/ProviderAction\";\nimport {\n  getAllProductFromOrderAPI,\n  getOrderStatusAPI,\n} from \"store/actions/OrderAction/OrderAction\";\nimport MDHeader from \"components/MerchantDashboard/MDHeader/MDHeader\";\nimport Loader from \"react-spinners/ScaleLoader\";\n\nfunction OrderDetail(props) {\n  const [loading, setLoading] = useState(false);\n  const {\n    user,\n    provider,\n    getAllOrderAPI,\n    getAllProductFromOrderAPI,\n    getOrderStatusAPI,\n  } = props;\n  const [statusOnView, setStatusOnView] = useState(-1);\n  const [orderList, setOrderList] = useState([]);\n  const [orderSummary, setOrderSummary] = useState(orderList[0]);\n  const [orderItems, setOrderItems] = useState([]);\n  let [color, setColor] = useState(\"#910000\");\n  const override = css`\n    display: block;\n    border-color: #910000;\n    font-size: 14px;\n    color: red;\n  `;\n  const filterOrderList = (type) => {\n    const filteredOrderList = orderListData.filter(\n      (order) => order.order_status === type\n    );\n    setOrderList(filteredOrderList);\n  };\n  useEffect(() => {\n    filterOrderList(props.type);\n  }, [props.type]);\n\n  //fetch order list for the first time\n  useEffect(() => {\n    async function fetchAllOrders(id) {\n      setLoading(false);\n      let limit = 50;\n      let offset = 1;\n      const result = await getAllOrderAPI(id, limit, offset);\n      setLoading(true);\n    }\n    //fetch new order list when order in store is empty\n    if (user.provider_id !== -1 && !provider.orderList.length) {\n      fetchAllOrders(user.provider_id);\n      return;\n    }\n    setLoading(true);\n  }, [user.provider_id]);\n\n  useEffect(() => {\n    if (user.provider_id !== -1) {\n      provider.socket.emit(\"join-room\", `provider-${user.provider_id}`);\n      console.log(`provider-${user.provider_id}`);\n      provider.socket.on(\n        \"provider-received-order\",\n        async (orderData, customerData, order_code, pricing) => {\n          console.log(\"check:\", orderData, customerData, order_code, pricing);\n\n          const result1 = await getAllProductFromOrderAPI(order_code);\n          const result2 = await getOrderStatusAPI(order_code);\n          Promise.all([result1, result2]).then((data) => {\n            setOrderItems(data[0]);\n            setOrderSummary(data[1]);\n            if (pricing.deliveryMode === 2) {\n              setStatusOnView(2);\n            } else {\n              setStatusOnView(1);\n            }\n          });\n        }\n      );\n      provider.socket.on(\"order-accepted\", (data) => {\n        setStatusOnView(2);\n      });\n    }\n  }, [user.provider_id]);\n\n  const viewOrderDetail = (code) => {\n    async function fetchOrderDetail(orderCode) {\n      const result1 = await getAllProductFromOrderAPI(orderCode);\n      const result2 = await getOrderStatusAPI(orderCode);\n      Promise.all([result1, result2]).then((data) => {\n        setOrderItems(data[0]);\n        setOrderSummary(data[1]);\n      });\n    }\n    fetchOrderDetail(code);\n  };\n\n  const mapOrderStatusIcon = (status) => {\n    switch (status) {\n      case 3:\n        return (\n          <>\n            <FontAwesomeIcon\n              className=\"o-order-icon-history inprogress\"\n              icon={faDotCircle}\n            />\n            <span className=\"order-status-text-blue\">Processing</span>\n          </>\n        );\n      case 5:\n        return (\n          <>\n            <FontAwesomeIcon\n              className=\"o-order-icon-history done\"\n              icon={faCheckCircle}\n            />\n            <span className=\"order-status-text-green\">Completed</span>\n          </>\n        );\n      case 6:\n        return (\n          <>\n            <FontAwesomeIcon\n              className=\"o-order-icon-history cancel\"\n              icon={faTimesCircle}\n            />\n            <span className=\"order-status-text-red\">Cancel</span>\n          </>\n        );\n      default:\n        return (\n          <>\n            <FontAwesomeIcon\n              className=\"o-order-icon-history pending\"\n              icon={faCircleNotch}\n            />\n            <span className=\"order-status-text-yellow\">Awaiting</span>\n          </>\n        );\n    }\n  };\n\n  return (\n    <Fragment>\n      <div className=\"double-panel-container\">\n        <div className=\"main-detail-panel-wrapper\">\n          <MDHeader visible={false} />\n          <div className=\"panel-detail-title\">Your orders</div>\n          <div className=\"product-list-info-row\">\n            <div className=\"product-list-info\">\n              <div className=\"product-stock-quantity\">\n                {provider.orderList.length} Orders\n              </div>\n              <div className=\"product-stock-quantity-description\">\n                {props.type} orders: {provider.orderList.length}\n              </div>\n              <div className=\"product-progress-bar\">\n                <ProgressBar\n                  bgcolor=\"#940000\"\n                  progress={`${provider.orderList.length}`}\n                  height=\"6px\"\n                  length={50}\n                />\n              </div>\n            </div>\n          </div>\n          <div className=\"o-order-container\">\n            <div className=\"o-order-header-row\">\n              <div className=\"o-order o-order-icon\">Order status</div>\n              <div className=\"o-order o-order-id\">Order Id</div>\n              <div className=\"o-order o-order-name\">Customer name</div>\n              <div className=\"o-order o-order-time\">Submitted time</div>\n              <div className=\"o-order o-order-quantity\">Payment</div>\n              <div className=\"o-order o-order-price\">Total</div>\n            </div>\n          </div>\n          {loading ? (\n            <div className=\"o-order-container\">\n              {provider.orderList?.map((order) => (\n                <div\n                  className=\"o-order-row\"\n                  onClick={() => {\n                    setStatusOnView(order.status);\n                    viewOrderDetail(order.order_code);\n                  }}\n                  key={order.order_code}\n                  style={\n                    orderSummary?.order_code === order?.order_code\n                      ? { backgroundColor: \"#f3f3f3\" }\n                      : { backgroundColor: \"white\" }\n                  }\n                >\n                  {mapOrderStatusIcon(order.status)}\n                  <div className=\"o-order o-order-id\">{order.order_code}</div>\n                  <div className=\"o-order o-order-name\">\n                    {`${order.user_first_name} ${order.user_last_name}`}\n                  </div>\n                  <div className=\"o-order-time\">{order.update_at}</div>\n                  <div className=\"o-order-quantity\">{order.payment_name}</div>\n                  <div className=\"o-order-price\">\n                    $ {order.total_amount?.toFixed(2)}\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div\n              className=\"o-order-container\"\n              style={{\n                height: 500,\n                display: \"flex\",\n                flexDirection: \"column\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                borderBottom: \"2px solid #d8d8d8\",\n                borderLeft: \"2px solid #d8d8d8\",\n                borderRight: \"2px solid #d8d8d8\",\n                gap: 10,\n              }}\n            >\n              <Loader\n                color={color}\n                loading={true}\n                css={override}\n                size={100}\n                margin={3}\n                speedMultiplier={0.8}\n              />\n              <span className=\"o-order-container-text\">\n                Please wait for a while ...\n              </span>\n            </div>\n          )}\n        </div>\n        <div className=\"sub-detail-panel-wrapper\" style={{ paddingTop: \"0\" }}>\n          <ViewOrderDetail\n            setOrderItems={setOrderItems}\n            setOrderSummary={setOrderSummary}\n            orderItems={orderItems}\n            orderSummary={orderSummary}\n            orderStatus={statusOnView}\n            socket={provider.socket}\n          />\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nOrderDetail.propTypes = {\n  user: PropTypes.object.isRequired,\n  provider: PropTypes.object.isRequired,\n  getAllOrderAPI: PropTypes.func.isRequired,\n  getAllProductFromOrderAPI: PropTypes.func.isRequired,\n  getOrderStatusAPI: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = (state) => ({\n  user: state.UserReducer,\n  provider: state.ProviderReducer,\n});\n\nexport default withRouter(\n  connect(mapStateToProps, {\n    getAllOrderAPI,\n    getAllProductFromOrderAPI,\n    getOrderStatusAPI,\n  })(OrderDetail)\n);\n"]},"metadata":{},"sourceType":"module"}