{"ast":null,"code":"var _jsxFileName = \"/Users/hoangnam/4thYear/FinalProject/18VP-Graduation_Project-Tastie-Frontend/delitaste/Frontend/src/components/OrderTracking/OrderStatus/OrderStatus.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useRef, Fragment } from \"react\";\nimport withAuth from \"components/HigherOrderComponents(HOC)/withAuth\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect, Provider } from \"react-redux\";\nimport { css } from \"@emotion/react\";\nimport Loader from \"react-spinners/BeatLoader\";\nimport PropTypes from \"prop-types\";\nimport \"./OrderStatus.scss\";\nimport Button from \"components/Commons/Button/Button\";\nimport ButtonGroup from \"components/Commons/Button/ButtonGroup/ButtonGroup\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport ChatBox from \"./ChatBox\";\nimport { faExclamationCircle, faTimes, faCommentDots } from \"@fortawesome/fontawesome-free-solid\";\nimport Step1Image from \"assets/order_progress/step1.gif\";\nimport Step3Image from \"assets/order_progress/step3.gif\";\nimport Step4Image from \"assets/order_progress/step4.gif\";\nimport Step5Image from \"assets/order_progress/step5.gif\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst shipper = {\n  name: \"Terry Harrison\",\n  license_plate: \"64B1 - 03663\",\n  rating: 5,\n  profile_image: \"https://pyxis.nymag.com/v1/imgs/231/dd4/b1d43dd12227a68877644b36e1b6c9850e-13-zayn-malik.rsquare.w330.jpg\"\n};\n\nfunction OrderStatus(props) {\n  _s();\n\n  var _props$orderSummary, _props$orderSummary2;\n\n  const {\n    user\n  } = props;\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const {\n    status\n  } = props;\n  const [showShipperChat, setShowShipperChat] = useState(false);\n  let [loading, setLoading] = useState(true);\n  let [color, setColor] = useState(\"#910000\");\n\n  const completePickUp = async () => {\n    try {\n      const res = await axios.post(\"/v1/api/tastie/order/update_order_status\", {\n        order_code: props.match.params.order_code,\n        status: 5,\n        // completed\n        shipper_id: null,\n        update_at: new Date().toISOString()\n      });\n\n      if (res.status) {\n        props.setCompletedStatus(true);\n        props.setCurrentStatus(5);\n      }\n    } catch (error) {\n      console.error(\"Cannot update order status\", error);\n    }\n  };\n\n  const override = css`\n    display: block;\n    border-color: #910000;\n    font-size: 14px;\n    color: red;\n  `;\n  useEffect(() => {\n    window.scrollTo({\n      top: 0,\n      behavior: \"auto\"\n    });\n  }, []);\n  const stepImage = [Step1Image, Step1Image, Step3Image, Step4Image, Step5Image];\n  const waitingMessage = [\"Order received. Working on it right now...\", \"Shipper assigned. Waiting for the restaurant order's confirmation.\", \"Restaurant confirmed. Shipper is on the way to the restaurant\", \"Shipper's on the way to pick up your order. Please wait for a while.\", \"Order completed\", \"Order canceled\"];\n  const statusMainText = [\"Order submitted\", \"Shipper assigned\", \"Restaurant confirmed\", \"Delivering\", \"Order delivered\", \"Order canceled\"];\n  const statusSubText = [\"Your order has been placed.\", \"Shipper is taking care of your order.\", \"Restaurant has confirmed your order and preparing for your dishes.\", \"Shipper has your order. You'll get an alert when it's at your door.\", \"Your order has been completed. Enjoy your meal.\", \"Order canceled\"];\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"or-st-container\",\n      style: {\n        marginBottom: 20\n      },\n      children: /*#__PURE__*/_jsxDEV(Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"or-st-head-bar\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"or-st-waiting\",\n            children: waitingMessage[status - 1]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"or-st-spinner\",\n            children: /*#__PURE__*/_jsxDEV(Loader, {\n              color: color,\n              loading: loading,\n              css: override,\n              size: 10,\n              margin: 2,\n              speedMultiplier: 0.8\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), status >= 2 && props.orderSummary.delivery_mode === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"or-st-shipper\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"or-st-shipper-image\",\n            src: shipper.profile_image,\n            width: 300,\n            alt: \"shipper_profile_image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"or-st-shipper-text-wrapper\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"or-st-sh-main-text\",\n              children: shipper.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"or-st-sh-sub-text\",\n              children: shipper.license_plate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"or-st-shipper-communication\",\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              className: \"shipper-chat-icon\",\n              icon: showShipperChat ? faTimes : faCommentDots,\n              onClick: () => setShowShipperChat(prev => !prev)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this), showShipperChat && ((_props$orderSummary = props.orderSummary) === null || _props$orderSummary === void 0 ? void 0 : _props$orderSummary.delivery_mode) === 1 ? /*#__PURE__*/_jsxDEV(ChatBox, {\n          shipper: shipper,\n          message: message,\n          setMessage: setMessage,\n          messages: messages,\n          setMessages: setMessages,\n          socket: user.socket\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"or-st-pre-body\",\n            children: [\"Latest arrival by 10:55am\", /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              className: \"or-st-icon\",\n              icon: faExclamationCircle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            style: status === 1 ? {\n              marginTop: 67\n            } : {},\n            className: \"or-st-image\",\n            src: stepImage[status - 1],\n            width: 300,\n            alt: \"step_1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"or-st-head-wrapper\",\n            children: statusMainText[status - 1]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"or-st-body-wrapper\",\n            children: props.orderSummary.delivery_mode !== 2 ? statusSubText[status - 1] : \"Check and come to the restaurant to pick up your order.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 15\n          }, this), \" \", props.orderSummary.delivery_mode === 2 && props.currentStatus === 3 && /*#__PURE__*/_jsxDEV(ButtonGroup, {\n            float: \"flex-start\",\n            mgTop: 10,\n            mgBottom: 0,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              color: \"white\",\n              bgColor: \"#810000\",\n              justifyContent: \"center\",\n              gap: \"10px\",\n              width: 180,\n              fontSize: 14,\n              height: 40,\n              label: `Complete order`,\n              onClick: () => completePickUp()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 19\n          }, this), ((_props$orderSummary2 = props.orderSummary) === null || _props$orderSummary2 === void 0 ? void 0 : _props$orderSummary2.delivery_mode) !== 2 ? /*#__PURE__*/_jsxDEV(ButtonGroup, {\n            float: \"flex-start\",\n            mgTop: 10,\n            mgBottom: 0,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              color: \"white\",\n              bgColor: \"#2c2c2c\",\n              justifyContent: \"center\",\n              gap: \"10px\",\n              width: 120,\n              fontSize: 14,\n              height: 35,\n              label: `Delivery detail`,\n              onClick: () => props.setShowOrderDetail(true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              marginTop: 15,\n              fontSize: 13,\n              fontStyle: \"italic\",\n              color: \"#810000\",\n              textDecoration: \"underline\",\n              cursor: \"pointer\"\n            },\n            onClick: () => props.setShowOrderDetail(true),\n            children: \"Order detail\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n\n_s(OrderStatus, \"D4kPlZImMjeAN49GOIlLhu1Wk4A=\");\n\n_c = OrderStatus;\nOrderStatus.propTypes = {\n  user: PropTypes.object.isRequired,\n  product: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n  user: state.UserReducer,\n  product: state.ProductReducer\n});\n\nexport default withRouter(withAuth(connect(mapStateToProps, null)(OrderStatus)));\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderStatus\");","map":{"version":3,"sources":["/Users/hoangnam/4thYear/FinalProject/18VP-Graduation_Project-Tastie-Frontend/delitaste/Frontend/src/components/OrderTracking/OrderStatus/OrderStatus.js"],"names":["useState","useEffect","useRef","Fragment","withAuth","withRouter","connect","Provider","css","Loader","PropTypes","Button","ButtonGroup","FontAwesomeIcon","ChatBox","faExclamationCircle","faTimes","faCommentDots","Step1Image","Step3Image","Step4Image","Step5Image","axios","shipper","name","license_plate","rating","profile_image","OrderStatus","props","user","message","setMessage","messages","setMessages","status","showShipperChat","setShowShipperChat","loading","setLoading","color","setColor","completePickUp","res","post","order_code","match","params","shipper_id","update_at","Date","toISOString","setCompletedStatus","setCurrentStatus","error","console","override","window","scrollTo","top","behavior","stepImage","waitingMessage","statusMainText","statusSubText","marginBottom","orderSummary","delivery_mode","prev","socket","marginTop","currentStatus","setShowOrderDetail","fontSize","fontStyle","textDecoration","cursor","propTypes","object","isRequired","product","mapStateToProps","state","UserReducer","ProductReducer"],"mappings":"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","sourcesContent":["import { useState, useEffect, useRef, Fragment } from \"react\";\nimport withAuth from \"components/HigherOrderComponents(HOC)/withAuth\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect, Provider } from \"react-redux\";\nimport { css } from \"@emotion/react\";\nimport Loader from \"react-spinners/BeatLoader\";\nimport PropTypes from \"prop-types\";\nimport \"./OrderStatus.scss\";\nimport Button from \"components/Commons/Button/Button\";\nimport ButtonGroup from \"components/Commons/Button/ButtonGroup/ButtonGroup\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport ChatBox from \"./ChatBox\";\nimport {\n  faExclamationCircle,\n  faTimes,\n  faCommentDots,\n} from \"@fortawesome/fontawesome-free-solid\";\nimport Step1Image from \"assets/order_progress/step1.gif\";\nimport Step3Image from \"assets/order_progress/step3.gif\";\nimport Step4Image from \"assets/order_progress/step4.gif\";\nimport Step5Image from \"assets/order_progress/step5.gif\";\nimport axios from \"axios\";\nconst shipper = {\n  name: \"Terry Harrison\",\n  license_plate: \"64B1 - 03663\",\n  rating: 5,\n  profile_image:\n    \"https://pyxis.nymag.com/v1/imgs/231/dd4/b1d43dd12227a68877644b36e1b6c9850e-13-zayn-malik.rsquare.w330.jpg\",\n};\n\nfunction OrderStatus(props) {\n  const { user } = props;\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const { status } = props;\n  const [showShipperChat, setShowShipperChat] = useState(false);\n  let [loading, setLoading] = useState(true);\n  let [color, setColor] = useState(\"#910000\");\n  \n  const completePickUp = async () => {\n    try {\n      const res = await axios.post(\"/v1/api/tastie/order/update_order_status\", {\n        order_code: props.match.params.order_code,\n        status: 5, // completed\n        shipper_id: null,\n        update_at: new Date().toISOString(),\n      });\n      if (res.status) {\n        props.setCompletedStatus(true);\n        props.setCurrentStatus(5);\n      }\n    } catch (error) {\n      console.error(\"Cannot update order status\", error);\n    }\n  };\n  const override = css`\n    display: block;\n    border-color: #910000;\n    font-size: 14px;\n    color: red;\n  `;\n  useEffect(() => {\n    window.scrollTo({ top: 0, behavior: \"auto\" });\n  }, []);\n  const stepImage = [\n    Step1Image,\n    Step1Image,\n    Step3Image,\n    Step4Image,\n    Step5Image,\n  ];\n  const waitingMessage = [\n    \"Order received. Working on it right now...\",\n    \"Shipper assigned. Waiting for the restaurant order's confirmation.\",\n    \"Restaurant confirmed. Shipper is on the way to the restaurant\",\n    \"Shipper's on the way to pick up your order. Please wait for a while.\",\n    \"Order completed\",\n    \"Order canceled\",\n  ];\n\n  const statusMainText = [\n    \"Order submitted\",\n    \"Shipper assigned\",\n    \"Restaurant confirmed\",\n    \"Delivering\",\n    \"Order delivered\",\n    \"Order canceled\",\n  ];\n  const statusSubText = [\n    \"Your order has been placed.\",\n    \"Shipper is taking care of your order.\",\n    \"Restaurant has confirmed your order and preparing for your dishes.\",\n    \"Shipper has your order. You'll get an alert when it's at your door.\",\n    \"Your order has been completed. Enjoy your meal.\",\n    \"Order canceled\",\n  ];\n\n  return (\n    <Fragment>\n      <div className=\"or-st-container\" style={{ marginBottom: 20 }}>\n        <Fragment>\n          <div className=\"or-st-head-bar\">\n            <span className=\"or-st-waiting\">{waitingMessage[status - 1]}</span>\n            <div className=\"or-st-spinner\">\n              <Loader\n                color={color}\n                loading={loading}\n                css={override}\n                size={10}\n                margin={2}\n                speedMultiplier={0.8}\n              />\n            </div>\n          </div>\n          {status >= 2 && props.orderSummary.delivery_mode === 1 && (\n            <div className=\"or-st-shipper\">\n              <img\n                className=\"or-st-shipper-image\"\n                src={shipper.profile_image}\n                width={300}\n                alt=\"shipper_profile_image\"\n              />\n              <div className=\"or-st-shipper-text-wrapper\">\n                <span className=\"or-st-sh-main-text\">{shipper.name}</span>\n                <span className=\"or-st-sh-sub-text\">\n                  {shipper.license_plate}\n                </span>\n              </div>\n              <div className=\"or-st-shipper-communication\">\n                <FontAwesomeIcon\n                  className=\"shipper-chat-icon\"\n                  icon={showShipperChat ? faTimes : faCommentDots}\n                  onClick={() => setShowShipperChat((prev) => !prev)}\n                />\n              </div>\n            </div>\n          )}\n          {showShipperChat && props.orderSummary?.delivery_mode === 1 ? (\n            <ChatBox\n              shipper={shipper}\n              message={message}\n              setMessage={setMessage}\n              messages={messages}\n              setMessages={setMessages}\n              socket={user.socket}\n            />\n          ) : (\n            <Fragment>\n              <span className=\"or-st-pre-body\">\n                Latest arrival by 10:55am\n                <FontAwesomeIcon\n                  className=\"or-st-icon\"\n                  icon={faExclamationCircle}\n                />\n              </span>\n              <img\n                style={status === 1 ? { marginTop: 67 } : {}}\n                className=\"or-st-image\"\n                src={stepImage[status - 1]}\n                width={300}\n                alt=\"step_1\"\n              />\n              <div className=\"or-st-head-wrapper\">\n                {statusMainText[status - 1]}\n              </div>\n              <div className=\"or-st-body-wrapper\">\n                {props.orderSummary.delivery_mode !== 2\n                  ? statusSubText[status - 1]\n                  : \"Check and come to the restaurant to pick up your order.\"}\n              </div>{\" \"}\n              {props.orderSummary.delivery_mode === 2 &&\n                props.currentStatus === 3 && (\n                  <ButtonGroup float=\"flex-start\" mgTop={10} mgBottom={0}>\n                    <Button\n                      color={\"white\"}\n                      bgColor={\"#810000\"}\n                      justifyContent={\"center\"}\n                      gap={\"10px\"}\n                      width={180}\n                      fontSize={14}\n                      height={40}\n                      label={`Complete order`}\n                      onClick={() => completePickUp()}\n                    />\n                  </ButtonGroup>\n                )}\n              {props.orderSummary?.delivery_mode !== 2 ? (\n                <ButtonGroup float=\"flex-start\" mgTop={10} mgBottom={0}>\n                  <Button\n                    color={\"white\"}\n                    bgColor={\"#2c2c2c\"}\n                    justifyContent={\"center\"}\n                    gap={\"10px\"}\n                    width={120}\n                    fontSize={14}\n                    height={35}\n                    label={`Delivery detail`}\n                    onClick={() => props.setShowOrderDetail(true)}\n                  />\n                </ButtonGroup>\n              ) : (\n                <span\n                  style={{\n                    marginTop: 15,\n                    fontSize: 13,\n                    fontStyle: \"italic\",\n                    color: \"#810000\",\n                    textDecoration: \"underline\",\n                    cursor: \"pointer\",\n                  }}\n                  onClick={() => props.setShowOrderDetail(true)}\n                >\n                  Order detail\n                </span>\n              )}\n            </Fragment>\n          )}\n        </Fragment>\n      </div>\n    </Fragment>\n  );\n}\n\nOrderStatus.propTypes = {\n  user: PropTypes.object.isRequired,\n  product: PropTypes.object.isRequired,\n};\n\nconst mapStateToProps = (state) => ({\n  user: state.UserReducer,\n  product: state.ProductReducer,\n});\n\nexport default withRouter(\n  withAuth(connect(mapStateToProps, null)(OrderStatus))\n);\n"]},"metadata":{},"sourceType":"module"}