{"ast":null,"code":"var _jsxFileName = \"/Users/hoangnam/4thYear/FinalProject/18VP-Graduation_Project-Tastie-Frontend/delitaste/Frontend/src/components/HigherOrderComponents(HOC)/withAuth.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { getAccessTokenAPI } from \"store/actions/UserAction/AuthAction\";\nimport { getCart } from \"store/actions/CartAction/CartAction\";\nimport { getUserProfileAPI, setLoading, getAddressBookAPI, setCurrentLocation } from \"store/actions/UserAction/UserAction\";\nimport { setDialogBox } from \"store/actions/UIComponentAction/DialogBoxAction\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function (WrappedComponent) {\n  class Authentication extends Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        userId: -1,\n        isLoading: true,\n        isAuth: false\n      };\n    }\n\n    async componentDidMount() {\n      const refreshToken = localStorage.getItem(\"refreshToken\");\n\n      if (refreshToken) {\n        const result = await this.props.getAccessTokenAPI(refreshToken);\n\n        if ((result === null || result === void 0 ? void 0 : result.isAuth) && (result === null || result === void 0 ? void 0 : result.accessToken)) {\n          this.setState({\n            isLoading: false\n          });\n          this.setState({\n            isAuth: true\n          });\n          const id = await this.props.getUserProfileAPI(result.accessToken);\n          this.setState({\n            userId: id\n          });\n        }\n\n        return;\n      }\n    }\n\n    async componentDidUpdate(prevProps, prevState) {\n      if (prevState.userId !== this.state.userId && this.state.userId !== -1) {\n        this.props.getAddressBookAPI(this.state.userId);\n        this.props.getCart(this.state.userId);\n      }\n    }\n\n    render() {\n      return /*#__PURE__*/_jsxDEV(WrappedComponent, {\n        isLoading: this.state.isLoading,\n        isAuth: this.state.isAuth,\n        ...this.props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }, this);\n    }\n\n  }\n\n  Authentication.propTypes = {\n    user: PropTypes.object.isRequired,\n    getAccessTokenAPI: PropTypes.func.isRequired,\n    getUserProfileAPI: PropTypes.func.isRequired,\n    getAddressBookAPI: PropTypes.func.isRequired,\n    setCurrentLocation: PropTypes.func.isRequired,\n    getCart: PropTypes.func.isRequired,\n    setLoading: PropTypes.func.isRequired,\n    setDialogBox: PropTypes.func.isRequired\n  };\n\n  const mapStateToProps = state => ({\n    user: state.UserReducer\n  });\n\n  return connect(mapStateToProps, {\n    getAccessTokenAPI,\n    getUserProfileAPI,\n    getAddressBookAPI,\n    setCurrentLocation,\n    getCart,\n    setLoading,\n    setDialogBox\n  })(Authentication);\n}","map":{"version":3,"sources":["/Users/hoangnam/4thYear/FinalProject/18VP-Graduation_Project-Tastie-Frontend/delitaste/Frontend/src/components/HigherOrderComponents(HOC)/withAuth.js"],"names":["React","Component","axios","PropTypes","connect","getAccessTokenAPI","getCart","getUserProfileAPI","setLoading","getAddressBookAPI","setCurrentLocation","setDialogBox","WrappedComponent","Authentication","constructor","props","state","userId","isLoading","isAuth","componentDidMount","refreshToken","localStorage","getItem","result","accessToken","setState","id","componentDidUpdate","prevProps","prevState","render","propTypes","user","object","isRequired","func","mapStateToProps","UserReducer"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { getAccessTokenAPI } from \"store/actions/UserAction/AuthAction\";\nimport { getCart } from \"store/actions/CartAction/CartAction\";\nimport {\n  getUserProfileAPI,\n  setLoading,\n  getAddressBookAPI,\n  setCurrentLocation,\n} from \"store/actions/UserAction/UserAction\";\nimport { setDialogBox } from \"store/actions/UIComponentAction/DialogBoxAction\";\n\nexport default function (WrappedComponent) {\n  class Authentication extends Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        userId: -1,\n        isLoading: true,\n        isAuth: false,\n      };\n    }\n\n    async componentDidMount() {\n      const refreshToken = localStorage.getItem(\"refreshToken\");\n      if (refreshToken) {\n        const result = await this.props.getAccessTokenAPI(refreshToken);\n        if (result?.isAuth && result?.accessToken) {\n          this.setState({ isLoading: false });\n          this.setState({ isAuth: true });\n          const id = await this.props.getUserProfileAPI(result.accessToken);\n          this.setState({ userId: id });\n        }\n        return;\n      }\n    }\n    async componentDidUpdate(prevProps, prevState) {\n      if (prevState.userId !== this.state.userId && this.state.userId !== -1) {\n        this.props.getAddressBookAPI(this.state.userId);\n        this.props.getCart(this.state.userId);\n      }\n    }\n    render() {\n      return (\n        <WrappedComponent\n          isLoading={this.state.isLoading}\n          isAuth={this.state.isAuth}\n          {...this.props}\n        />\n      );\n    }\n  }\n  Authentication.propTypes = {\n    user: PropTypes.object.isRequired,\n    getAccessTokenAPI: PropTypes.func.isRequired,\n    getUserProfileAPI: PropTypes.func.isRequired,\n    getAddressBookAPI: PropTypes.func.isRequired,\n    setCurrentLocation: PropTypes.func.isRequired,\n    getCart: PropTypes.func.isRequired,\n    setLoading: PropTypes.func.isRequired,\n    setDialogBox: PropTypes.func.isRequired,\n  };\n  const mapStateToProps = (state) => ({\n    user: state.UserReducer,\n  });\n\n  return connect(mapStateToProps, {\n    getAccessTokenAPI,\n    getUserProfileAPI,\n    getAddressBookAPI,\n    setCurrentLocation,\n    getCart,\n    setLoading,\n    setDialogBox,\n  })(Authentication);\n}\n"]},"metadata":{},"sourceType":"module"}